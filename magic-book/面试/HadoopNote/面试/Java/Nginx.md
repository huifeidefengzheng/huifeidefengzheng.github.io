
# nginx

Q1：什么是DNS解析域名
将域名解析为实际的IP地址，域名最终通过DNS解析之后，转换为IP地址

Q2：你用过那些外网映射工具
Natapp

Q3：什么是Nginx
Nginx是一款轻量级的Web服务器/反向代理服务器及电子邮件（IMAP/POP3）代理服务器，其特点是占有内存少，并发能力强。

Q4：Nginx的作用
作为Web 服务器：相比Apache，Nginx 使用更少的资源，支持更多的并发连接，体现更高的效率。
作为负载均衡服务器使用C编写，属于基于应用层的七层负载均衡服务器。
同时还可以作为邮件代理服务器

Q5：Nginx 应用场景
Nginx可以作为http服务器（使用Nginx做静态服务器、海报服务器）
可以作为虚拟主机，将一台服务器，拆分多个网站部署
反向代理：使用反向代理隐藏真实IP访问地址
负载均衡：集群、减少单台服务器压力、故障转移（重试机制、但会引起幂等问题，不建议使用、健康检查tcp&http心跳检测）
Nginx也可以配置安全管理，如可以使用Nginx搭建API接口网关，对每个接口服务进行拦截

Q6：什么是反向代理

反向代理是指以代理服务器来接受客户端的连接请求，然后将请求转发给内部网络上的服务器，并将从服务器上得到的结果返回给客户端。

Q7：反向代理的作用
提高安全性，隐藏真实IP地址

Q8：Nginx如何配置反向代理
配置proxy_pass

Q9：说说常用Nginx的相关配置

proxy_pass配置反向代理
upstream配置负载均衡

Q10：请画图展示反向代理流程

Q11：LVS与Nginx区别
LVS基于第四层传输层通过改写报文地址可以应用在所有场景的负载均衡（Web服务、数据库等），扛并发能力比Nginx要好，区别于F5的硬件负载，它是一种软负载。
Nginx基于第七层应用层Http协议实现反向代理与负载均衡（1.9之后才提供对四层负载均衡的支持）。
Nginx可以通过服务器处理网页返回的状态吗、超时等来检测服务器内部的故障，并会把返回错误的请求重新发送到另一个节点。目前LVS也支持对服务器内部情况的监控，但不能重新发送请求。
Nginx同样能承受很高负载并且能稳定运行，由于处理流量受限于机器I/O等配置，所以负载能力相对较差。
Nginx安装、配置及测试相对来说比较简单，因为有相应的错误日志进行提示。LVS的安装、配置及测试所花的时间比较长，因为LVS对网络依赖比较大，很多时候有可能因为网络问题而配置不能成功。出现问题时，解决的难度也相对较大。Nginx本身没有现成的热备方案，所以在单机上运行风险较大，建议KeepAlived配合使用。另外，Nginx可以作为LVS的节点机器使用，充分利用Nginx的功能和性能。

Q12：location的作用
location指令的作用是根据用户请求的URI来执行不同的应用，也就是根据用户请求的网站URL进行匹配，匹配成功即进行相关的操作。
Q13：Nginx中如何配置负载均衡
配置upstream
Q14：四层负载均衡与七层负载均衡区别
四层负载均衡主要在传输层实现负载均衡，针对于TCP协议
七层负载均衡主要在应用层实现负载均衡，针对于HTTP协议

Q15：四层负载均衡有那些实现方案
LVS的软负载、F5的硬件负载、Nginx1.9之后的对四层负载均衡的支持（配置TCP）

Q16：负载均衡有那些算法
轮询、权重、IP绑定、fail、url绑定

Q17：服务器集群后，会产生了那些问题
分布式Session一致性问题
分布式Job幂等性问题
分布式生成全局ID问题
分布式锁解决方案
分布式配置中心
分布式日志收集问题

Q18：什么是动态负载均衡

传统的负载均衡，如果upstream参数发生变化，每次都需要重新加载nginx.conf文件，因此扩展性不是很高。所以我们可以采用动态负载均衡，实现upstream可配置化、动态化，无需人工重新加载nginx.conf。类似分布式的配置中心

Q19：Nginx如何实现动态负载均衡
Consul+upsync+Nginx实现无需reload的动态负载均衡

Q20：什么是Http协议
是一种超文本传输协议，底层基于传输层TCP协议封装。

Q21：Http协议组成部分
Http协议分为两种报文：请求报文request message和响应报文response报文，他们都包括首行、头部和主体三个部分
请求首行包括请求URL、参数、HTTP版本和请求方法
请求头部包括浏览器的信息来源
响应头部包括响应的状态码、HTTP版本

Q22：TCP与UDP区别
UPD:
是面向无连接，将数据及源的封装成数据包中，不需要建立连接
每个数据报的大小限制在64k以内
因为是无连接，所以是不可靠协议
不需要建立连接，速度快
TCP：
建立连接，形成传输数据的通道
在连接中进行大数据量传输，以字节流方式
通过三次握手完成连接，是可靠协议
必须建立连接，所以效率会稍低
Q23：谈谈七层网络模型
七层网络模型OSI是一种标准的参考模型，分为物理层、物理链路层、网络层、传输层、会话层、表示层、应用层，它主要应用于教学，实际中使用更多的是TCP/IP的4层模型

Q24：Nginx如何实现TCP四层负载均衡
Nginx至少是1.9版本，并且需要安装stream模块以支持TCP负载均衡（默认不安装），并且将配置文件中的http模块改成tcp模块

Q25：lvs与keepalived区别

LVS可以实现负载均衡，但是不能够进行健康检查，比如一个rs出现故障，LVS 仍然会把请求转发给故障的rs服务器，这样就会导致请求的无效性。keepalive 软件可以进行健康检查，而且能同时实现LVS 的高可用性，解决LVS 单点故障的问题，其实keepalive就是为LVS而生的。

Q26：keepalived 作用
Keepalived是在LVS基础之上，实现心跳检测、监控服务器实现故障转移，如果服务器发生宕机的时候，可以尝试自动重试脚本。如果多次重试还是失败可以发送邮件给运维，从而实现高可用。

Q27如何实现双机主从热备

使用lvs+Keepalived+Nginx每个服务虚拟安装keepalived虚拟一个VIP，（Virtual IP）配置主从关系，当主挂了，直接切换到备机。

Q29：项目发布如何不影响到正常用户访问，实现7*24小时访问

使用lvs+Keepalived+Nginx搭建高可用系统，发布版本前先将现网服务切换到备Nginx，然后在主环境发布完后切回主环境（同时准备好回退版本），然后验证无误后再把备环境也更新到最新版本。

Q30：项目如何发生故障宕机了，如何处理。
一般有四种解决思路：故障转移、心跳检测、负载均衡、自动重启

Q31：动态网站与静态网站区别
动态网站就是html源码多次请求都不会改变的网站
静态网站就是html源码多次请求可能会改变的网站

Q32：动态页面静态化的作用
动态页面静态化可以提高搜索排名

Q33：什么是动静分离架构模式
将一个系统中的动态资源（jsp、servlet）和静态资源（js、html、img、css）进行分离，分别部署在不同的服务器上，如静态资源部署在Nginx上、动态资源部署在Tomcat上。

Q34：如何搭建动静分离
可以使用域名或者文件后缀（location）区分静态资源请求和动态资源请求，然后通过Nginx的反向代理转发到不同的服务器上。

Q35：动静分离与前后分离区别
动静分离是指动态资源与静态资源进行分离，不会部署在同一台服务器上
前后分离是一种网站的架构模式，后台和前端都采用调接口的方式，将一个项目的视图层和逻辑层进行拆分、使用RPC远程调用技术进行相互通信。

Q36：如何控制浏览器静态资源缓存
可以通过增加时间戳的方式
第一次加载资源的时候，客户端将保存修改资源的时间
第二次加载原的时候，服务端哦按段当前资源文件与客户端上一次修改时间是否相同从而返回200或者304
Q37：Http状态码304的作用
304表示走本地缓存，不会再从服务器端拉取资源
